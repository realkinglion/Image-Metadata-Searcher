# 画像メタ情報検索くん v2.0 取扱説明書（改善版）

## 📖 1. はじめに

この度は、「画像メタ情報検索くん」をご利用いただき、誠にありがとうございます。

本アプリケーションは、お使いのコンピュータに保存されているたくさんの画像の中から、画像に含まれている「メタ情報」を頼りに、目的の画像を素早く探し出すためのソフトウェアです。

特に、AIで画像を作成した際に記録される**プロンプト（画像を作るための『呪文』や『命令文』）**をもとに検索することを得意としています。この説明書を参考に、快適な画像管理をご体験ください。

---

## ⚠️ セキュリティとご注意事項

### 🚨 重要：ダウンロード前に必ずお読みください

- **信頼できる配布元からのみダウンロード**してください
- ダウンロード後、**ウイルス対策ソフトで事前スキャン**することを強く推奨します
- `.exe`ファイルや`.bat`ファイルは、悪意のあるプログラムにも使われることがあります
- 怪しいと感じたら、使用を中止してください

### 📋 システム要件

- **OS**: Windows 10/11 推奨（Windows 8.1以降で動作）
- **Python**: 3.7以降必須（3.9以降推奨）
- **メモリ**: 4GB以上（画像数に応じて増加）
- **ディスク容量**: 100MB以上の空き容量
- **権限**: 通常のユーザー権限（管理者権限不要）

---

## 🚀 2. 導入と準備（初回のみ）

### 🎯 簡単導入コース
**すぐに使いたい方向け**
- 「画像メタ情報検索くん.exe」をダブルクリックするだけで起動します
- ただし、ウイルス対策ソフトが警告を表示する場合があります

### 🔧 手動導入コース
**セキュリティを重視される方・カスタマイズしたい方向け**

#### ステップ1：Pythonのインストール

1. [Python公式サイト](https://www.python.org/downloads/)からPythonをダウンロード
2. インストール時に**必ず**「Add Python to PATH」にチェックを入れる
   ```
   ⚠️ 重要：このチェックを忘れると起動できません
   ```
3. インストール完了後、コマンドプロンプトで以下を実行して確認：
   ```
   python --version
   ```

#### ステップ2：ファイルの準備

デスクトップなど分かりやすい場所に新しいフォルダを作成し（例：「画像検索アプリ」）、以下のファイルを配置：

- `search_app.py`（アプリケーション本体）
- `install.bat`（初回セットアップ用）
- `run_search_app.bat`（起動用）

**install.bat の中身**:
```batch
@echo off
echo 必要なライブラリをインストールします...
pip install --upgrade pip
pip install Pillow>=8.0.0 exifread>=2.3.0 watchdog>=2.0.0
echo.
echo インストール完了！
echo 今後は run_search_app.bat で起動できます。
pause
```

**run_search_app.bat の中身**:
```batch
@echo off
title 画像メタ情報検索くん v2.0
echo 画像メタ情報検索くんを起動しています...
python search_app.py
if %errorlevel% neq 0 (
    echo.
    echo エラーが発生しました。
    echo Python または必要なライブラリが不足している可能性があります。
    echo install.bat を実行してください。
    echo.
    pause
)
```

#### ステップ3：必要な「部品」のインストール

1. `install.bat`をダブルクリックして実行
2. 黒い画面でインストールが自動実行される
3. 「続行するには何かキーを押してください...」でキーを押す
4. エラーが表示された場合は、トラブルシューティングを参照

---

## 🎮 3. アプリケーションの起動

準備完了後は、`run_search_app.bat`をダブルクリックするだけで起動します。

**初回起動時に生成されるファイル**:
- `search_history.json` - 検索履歴
- `metadata_cache.json` - メタデータキャッシュ
- `favorites.json` - お気に入り設定

*これらのファイルは自動生成されるため、手動で作成する必要はありません。*

---

## 🖥️ 4. 基本的な使い方

### 📱 4.1. 画面の構成

*[📸 メイン画面のスクリーンショットをここに挿入]*

1. **検索設定エリア（左上）**: どこを、どんな言葉で探すかを指定
2. **機能エリア（中上）**: 履歴の呼び出しや、ファイル操作など
3. **表示・ソート設定エリア（右上）**: 並べ方や表示数を設定
4. **検索結果エリア（下半分）**: 見つかった画像を一覧表示

### 🔍 4.2. 検索の基本手順

#### 手順1：検索対象フォルダを指定
- 「フォルダ選択」ボタンをクリック
- 画像が保存されているフォルダを選択

#### 手順2：検索キーワードを入力
**例：**
- `1girl` - 女の子が描かれた画像
- `blue hair` - 青い髪の画像
- `cat ears` - 猫耳の画像

#### 手順3：検索オプションを設定（任意）
- **AND検索**: すべてのキーワードを含む画像のみ
- **一部一致/完全一致**: 検索の厳密さを調整
- **ネガティブ含む**: ネガティブプロンプトも検索対象に
- **サブフォルダも検索**: 子フォルダ内も検索

#### 手順4：検索実行
青い「検索スタート」ボタンをクリック

*[📸 検索結果表示のスクリーンショットをここに挿入]*

### 🖱️ 4.3. 検索結果の操作

#### 画像の選択
- **単一選択**: サムネイルを1回クリック
- **全選択**: 「すべて選択」ボタン
- **選択解除**: 「すべて解除」ボタン

#### 画像の表示
- **拡大表示**: サムネイルをダブルクリック
- **矢印キー**: ビューア内で画像移動
- **ズーム**: Ctrl + Plus/Minus キー

#### ページ移動
- **前/次ページ**: 「前」「次」ボタン
- **直接移動**: ページ番号入力 → 「ページ移動」

### 📁 4.4. ファイルのコピーと移動

1. 対象画像を選択（複数可）
2. 「保存先選択」で移動先フォルダを指定
3. 「コピー」または「移動」ボタンを実行

**注意**: 移動は元ファイルが削除されます。重要なファイルはコピーを推奨。

---

## ⭐ 5. 便利な機能（応用編）

### 🖱️ 右クリックメニュー

*[📸 右クリックメニューのスクリーンショットをここに挿入]*

画像のサムネイルを右クリックで表示される機能：

#### 📋 プロンプト関連
- **ベースプロンプトをコピー**: メイン部分の呪文
- **キャラクタープロンプトをコピー**: キャラクター別の呪文
- **ベース/キャラクターネガティブをコピー**: 除外呪文

#### 📄 ファイル操作
- **メタ情報表示**: 詳細なメタデータを確認
- **ファイル名コピー**: ファイル名をクリップボードに
- **名前変更**: ファイルのリネーム
- **フォルダを開く**: エクスプローラーで位置を表示

### 🎯 検索オプション詳細

#### マッチタイプ
- **一部一致**: `girl`で`1girl`や`schoolgirl`もヒット
- **完全一致**: 入力した文字列と完全に同じもののみ

#### 論理演算
- **AND検索**: `cat girl`→ 両方含む画像
- **OR検索**: `cat girl`→ どちらか含む画像

#### 特殊オプション
- **ネガティブ含む**: 通常は検索対象外のネガティブプロンプトも検索
- **サブフォルダ検索**: 階層下のフォルダも対象に

### 💾 履歴とお気に入り

#### 検索履歴
- 過去の検索条件を自動保存
- プルダウンから再選択可能
- ソート方法を変更可能（追加順/ディレクトリ順/キーワード順）

#### お気に入り設定
「お気に入り設定保存」で現在の設定を保存：
- 検索対象フォルダ
- 各種オプション設定
- 表示設定

### 🎨 表示のカスタマイズ

#### ソートオプション
- **ファイル名順**（昇順/降順）
- **更新日時順**（昇順/降順）
- **解像度順**（昇順/降順）

#### 表示設定
- **最大表示件数**: 1ページあたりの画像数
- **サムネイルサイズ**: 自動調整

---

## 🛠️ 6. トラブルシューティング

### ❌ よくあるエラーと対処法

#### 「'python' は...認識されていません」
**原因**: PythonのPATH設定が不完全
**対処法**:
1. Pythonを再インストール
2. インストール時に「Add Python to PATH」に必ずチェック
3. コマンドプロンプトで `python --version` で確認

#### 「ModuleNotFoundError: No module named '●●●'」
**原因**: 必要なライブラリが未インストール
**対処法**:
1. `install.bat` を再実行
2. 個別インストール: `pip install ライブラリ名`
3. 管理者権限で実行を試す

#### 「Permission denied」または「アクセスが拒否されました」
**原因**: ファイル/フォルダへのアクセス権限不足
**対処法**:
1. フォルダの読み取り権限を確認
2. 他のアプリケーションでファイルを開いていないか確認
3. ウイルス対策ソフトのリアルタイム保護を一時停止

#### 日本語ファイル名で文字化け
**原因**: システムエンコーディングの問題
**対処法**:
1. Windows設定でシステムロケールをUTF-8に変更
2. ファイル名に特殊文字が含まれていないか確認

#### アプリが重い・固まる
**原因**: 大量ファイルの処理またはメモリ不足
**対処法**:
1. 検索対象フォルダを小分けする
2. 「最大表示件数」を減らす
3. 不要なアプリケーションを終了してメモリを確保

### 🔧 高度なトラブルシューティング

#### キャッシュファイルの問題
症状: 古い情報が表示される/検索結果がおかしい
対処: 以下のファイルを削除して再起動
- `metadata_cache.json`
- `search_history.json`

#### 依存関係の完全確認
以下のコマンドで必要なライブラリが揃っているか確認：
```bash
python -c "import tkinter, threading, json, PIL, exifread, watchdog; print('All modules OK!')"
```

---

## 🆘 7. サポートとヘルプ

### 📞 困った時は

1. **まずこの説明書の該当箇所を確認**
2. **トラブルシューティングを実行**
3. **エラーメッセージを正確に記録**
4. **システム情報を確認**（Windows版、Python版など）

### 📊 システム情報の確認方法

```bash
# Pythonバージョン確認
python --version

# インストール済みライブラリ確認
pip list

# システム情報
systeminfo
```

### 🐞 バグ報告時に含めてほしい情報

- OSバージョン
- Pythonバージョン
- エラーメッセージの全文
- 再現手順
- スクリーンショット（可能であれば）

---

## 📝 8. 更新履歴とライセンス

### 🔄 バージョン情報
- **v2.0**: 機能統合版（現在）
- **v1.x**: 初期版

### ⚖️ ライセンス
[ライセンス情報をここに記載]

### 🙏 クレジット
このアプリケーションは以下のオープンソースライブラリを使用しています：
- Python
- Tkinter
- Pillow (PIL)
- ExifRead
- Watchdog

---

## 🎉 おわりに

このアプリケーションが、あなたのAI画像生成ライフと創作活動の一助となれば幸いです。

快適な画像管理をお楽しみください！

---

*📅 最終更新: [更新日付]*
*📖 バージョン: 2.0*
